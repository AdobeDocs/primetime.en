<?xml version="1.0"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="reference_C8850070D37343B3883B68F77C183EDA"> 
  <title>Implementing an early ad break return</title> 
  <shortdesc>For live stream ad insertion, you might need to exit from an ad
	 break before all the ads in the break are played to completion. 
  </shortdesc> 
  <refbody> 
	 <refsyn id="refsyn_F1FC56AF20C94BC9802F553CB9F12014">
		<note type="other" othertype="Prerequisite">You must subscribe to the
		  splice out/in ad markers
		  (<codeph>#EXT-X-CUE-OUT</codeph>,<codeph>#EXT-X-CUE-IN</codeph>, and 
		  <codeph>#EXT-X-CUE</codeph>). 
		</note> 
	 </refsyn> 
	 <refsyn id="refsyn_0698D86E47FA466A81B12156733BBDBE">Here are some
		requirements to consider: 
		<ul id="ul_B9FA5E7D4B0D4249A12956880BEE324F"> 
		  <li id="li_1090B95FF1B244B1B2B605C6D9F5F3C5">Parse markers such as 
			 <codeph>EXT-X-CUE-IN</codeph> (or equivalent marker tag) that appear
			 in the linear or FER streams. 
			 <p>Register the markers as being the marker for ad early return
				point. Only play 
				<codeph>adBreaks</codeph> until this marker position during
				playback, which override the duration of the 
				<codeph>adBreak</codeph> marked by the leading 
				<codeph>EXE-X-CUE-OUT</codeph> marker. 
			 </p> 
		  </li> 
		  <li id="li_46F9F2AF446348B9AA720873032D8248">If two 
			 <codeph>EXT-X-CUE-IN</codeph> markers exist for the same 
			 <codeph>EXT-X-CUE-OUT</codeph> marker, the first 
			 <codeph>EXT-X-CUE-IN</codeph> marker that appears is the one that
			 counts. 
		  </li> 
		  <li id="li_E987D6B23D68455F9E2B47AD170DD9EE">If the 
			 <codeph>EXE-X-CUE-IN</codeph> marker appears in the timeline without
			 a leading 
			 <codeph>EXT-X-CUE-OUT</codeph> marker, the 
			 <codeph>EXE-X-CUE-IN</codeph> marker is discarded. 
			 <p>In a live stream, if the leading 
				<codeph>EXT-X-CUE-OUT</codeph> marker has just moved out of the
				window, the TVSDK will not respond to it. 
			 </p> 
		  </li> 
		  <li id="li_4AC18720094048BE8E725C1C86A20B4A">When there is an early
			 return from an ad break, the 
			 <codeph>adBreak</codeph> plays until the playhead returns to the
			 original position when the ad break was supposed to end and resumes playing the
			 main content from that position. 
		  </li> 
		</ul>
	 </refsyn>
	 <section id="section_36DD55BA58084E21BD3DC039BB245C82"> 
		<title>SpliceOut and SpliceIn</title> 
		<p><codeph>SpliceOut</codeph> and 
		  <codeph>SpliceIn</codeph> markers mark the begin and the end of the ad
		  break. The duration of the 
		  <codeph>SpliceOut</codeph> type of the 
		  <codeph>EXE-X-CUE</codeph> marker might be zero and the 
		  <codeph>SpliceIn</codeph> type of 
		  <codeph>EXE-X-CUE</codeph> marker marks the end of the ad break. They
		  appear in one tag and differ by type. 
		</p> 
		<p><b>One marker with different types</b> 
		</p> 
		<p>For example, here is one marker with different types: 
		  <codeblock outputclass="syntax actionscript">#EXTM3U#EXT-X-TARGETDURATION:10
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:44
  
#EXTINF:9.9,
http://server-host/path/file44.ts
#EXTINF:4.2,
http://server-host/path/file45.ts
  
#EXT-X-CUE:TYPE="SpliceOut",ID="1",DURATION="0",TIME="266.198",PROGRAM-ID="138",AVAIL-NUM="1",AVAILS-EXPECTED="10"
#EXTINF:5.8,
http://server-host/path/file46.ts
#EXTINF:9.9,
http://server-host/path/file47.ts
...
#EXTINF:9.9,
http://server-host/path/file56.ts
#EXTINF:4.2,
http://server-host/path/file57.ts
#EXT-X-CUE:TYPE="SpliceIn",ID="1",DURATION="0",TIME="266.198",PROGRAM-ID="138"
#EXTINF:9.9,
http://server-host/path/file58.ts</codeblock> 
		</p> 
		<p>In the one marker with different types example, if the duration of the
		  
		  <codeph>SpliceOut</codeph> type is zero, the 
		  <codeph>SpliceOut</codeph> and 
		  <codeph>SpliceIn</codeph> must work together for every ad break.
		  Currently, a 
		  <codeph>SpliceOut</codeph> marker with a non-zero duration and doesn't
		  need pairing 
		  <codeph>SpliceIn</codeph> markers is more typical. 
		</p> 
		<p><b>Two separate markers</b> 
		</p> 
		<p>The more typical scenario is a 
		  <codeph>SpliceOut</codeph> marker with a non-zero duration and that
		  does not need the pairing 
		  <codeph>SpliceIn</codeph> markers. Here, a pairing 
		  <codeph>SpliceIn</codeph> marker marks the end the ad break during ad
		  break playback, but the ad break is cut short at the 
		  <codeph>SpliceIn</codeph> marker position, and the main content starts
		  playing at this position. 
		</p> 
		<p>For example, here are two separate markers: 
		  <codeblock outputclass="syntax actionscript">#EXT-X-CUE-OUT:ID=105,DURATION=30.0,TIME=1081.08
#EXTINF:6.006000,no-desc
/live/hls/nbc-fer/QualityLevels(2200000)/Fragments(video=14332589090425811,format=m3u8-aapl-v4)
#EXTINF:6.006000,no-desc
/live/hls/nbc-fer/QualityLevels(2200000)/Fragments(video=14332589150485811,format=m3u8-aapl-v4)
#EXTINF:6.006000,no-desc
/live/hls/nbc-fer/QualityLevels(2200000)/Fragments(video=14332589210545811,format=m3u8-aapl-v4)
#EXTINF:6.006000,no-desc
/live/hls/nbc-fer/QualityLevels(2200000)/Fragments(video=14332589270605811,format=m3u8-aapl-v4)
#EXT-X-CUE-IN:ID=105,TIME=1105.104
#EXTINF:6.006000,no-desc
/live/hls/nbc-fer/QualityLevels(2200000)/Fragments(video=14332589330665811,format=m3u8-aapl-v4)</codeblock> 
		</p> 
	 </section> 
  </refbody> 
</reference> 
