<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="t_psdk_mark-ranges-ios"> 
  <title>Mark ranges</title> 
  <shortdesc/> 
  <taskbody> 
	 <context id="context_FD644193580E44A1BEC94A2E001FF5F4">To implement the 
		<codeph>PTTimeRangeCollection</codeph> and mark ranges of content as ads:
		
	 </context> 
	 <steps id="steps_E4FEB15BC454404D95D8953C706D3491"> 
		<step id="step_996FCEC17D064EC39E0FD31703DE4DBA"> 
		  <cmd>Prepare the 
			 <codeph>PTTimeRangeCollection</codeph>. 
		  </cmd> 
		</step> 
		<step id="step_50CAAA96897A499AA4A5ABF09DB7A26C">
		  <cmd>Set the type of the 
			 <codeph>PTTimeRangeCollection</codeph> to 
			 <codeph>PTTimeRangeCollectionTypeMarkRanges</codeph>. 
		  </cmd>
		  <info>
			 <p>This step notifies 
				<ph
				 conkeyref="phrases/primetime-sdk-name"><?xm-replace_text Phrase?></ph>
				that the custom ranges must be treated like ads. 
			 </p> 
			 <codeblock outputclass="syntax objective-c">#define PSDK_TIMESCALE 100000
     
NSArray *ranges =  @[
  [PTReplacementRange 
    replacementRangeWithRange:CMTimeRangeMake(CMTimeMakeWithSeconds
      (0, PSDK_TIMESCALE),CMTimeMakeWithSeconds(60, AD_TIMESCALE))],
  [PTReplacementRange 
    replacementRangeWithRange:CMTimeRangeMake(CMTimeMakeWithSeconds
      (120, PSDK_TIMESCALE),CMTimeMakeWithSeconds(60, AD_TIMESCALE))]
];
     
PTTimeRangeCollection *timeRangeCollection = 
  [[PTTimeRangeCollection alloc] initWithRanges:ranges 
    type:PTTimeRangeCollectionTypeMarkRanges];</codeblock> 
		  </info>
		</step>
		<step id="step_9D4497A4E3F34FCCAB0CAFDEDDC62247"> 
		  <cmd>Create the 
			 <codeph>PTAdMetadata</codeph> and set the 
			 <codeph>PTTimeRangeCollection</codeph>.
		  </cmd> 
		  <info> 
			 <codeblock outputclass="syntax objective-c">// Create the PTPlayerItem metadata
PTMetadata *metadata = [[PTMetadata alloc] init];
 
// Create the Ad metadata
PTAuditudeMetadata *adMetadata = [[PTAuditudeMetadata alloc] init];
adMetadata.timeRangeCollection = timerangeCollection;
 
//Set Ad metadata
[metadata setMetadata:adMetadata forKey:PTAdResolvingMetadataKey];
 
//Create PTMediaPlayerItem
PTMediaPlayerItem *playerItem = [[[PTMediaPlayerItem alloc] initWithUrl:mediaUrl
                                                                mediaId:mediaId
                                                               metadata:metadata];</codeblock> 
		  </info> 
		</step> 
		<step id="step_7A829CC45E854AB2B2741F593926BA4B"> 
		  <cmd>Create the player and start playback. 
		  </cmd> 
		  <info> 
			 <codeblock outputclass="syntax objective-c">//Create PTMediaPlayer using the created PTMediaPlayer
PTMediaPlayer *player = [PTMediaPlayer playerWithMediaPlayerItem:playerItem];
 
//Add player to the player UIView
[self.playerView addSubview:(UIView *)player.view];
 
//Start playback
[player play];</codeblock> 
		  </info> 
		</step> 
	 </steps> 
  </taskbody> 
</task> 
